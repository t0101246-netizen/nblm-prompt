<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nbLM È¢®Ê†ºÊåá‰ª§ÂØ¶È©óÂÆ§ v3.4 (Anti-Deform)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        select { 
            -webkit-appearance: none; 
            -moz-appearance: none; 
            appearance: none; 
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E"); 
            background-position: right 0.5rem center; 
            background-repeat: no-repeat; 
            background-size: 1.5em 1.5em; 
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen">

    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="bg-indigo-600 text-white px-3 py-1 rounded-lg font-bold text-xl tracking-tight">nbLM</div>
                    <h1 class="text-lg md:text-xl font-bold text-slate-900">È¢®Ê†ºÊåá‰ª§ÂØ¶È©óÂÆ§ <span class="text-xs font-normal text-indigo-600 bg-indigo-50 border border-indigo-200 px-2 py-0.5 rounded-full ml-2">v3.4 Anti-Deform</span></h1>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4 md:p-8 grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <div class="lg:col-span-5 space-y-6">
            
            <section class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-indigo-300 transition-colors">
                <h2 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-indigo-500"></span> 1. ÈÅ∏ÊìáËº∏Âá∫Ê†ºÂºè (Format)
                </h2>
                <div class="grid grid-cols-2 gap-3" id="type-container">
                    </div>
            </section>

            <section class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 relative hover:border-indigo-300 transition-colors">
                <h2 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-pink-500"></span> 2. ÂÆöÁæ©È¢®Ê†ºÊøæÈè° (Style Filter)
                </h2>
                
                <div class="mb-4">
                    <label class="block text-sm font-semibold text-slate-700 mb-1.5">È¢®Ê†ºÊµÅÊ¥æ (Genre)</label>
                    <div class="relative">
                        <select id="category-select" class="w-full p-3 pl-4 pr-10 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-slate-50 font-medium text-slate-700 transition cursor-pointer">
                            </select>
                    </div>
                </div>

                <div class="mb-5">
                    <label class="block text-sm font-semibold text-slate-700 mb-1.5">ÂÖ∑È´îÈ¢®Ê†º (Specific Style)</label>
                    <div class="relative">
                        <select id="style-select" class="w-full p-3 pl-4 pr-10 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white font-medium text-slate-900 shadow-sm transition cursor-pointer">
                            </select>
                    </div>
                </div>

                <div class="p-4 bg-indigo-50 rounded-lg border border-indigo-100 relative overflow-hidden group">
                    <div class="relative z-10">
                        <div class="text-indigo-900 font-bold text-sm mb-1 flex items-center gap-2">
                            <span id="style-name-display">ËºâÂÖ•‰∏≠...</span>
                        </div>
                        <p class="text-indigo-700 text-xs leading-relaxed" id="style-desc-display">...</p>
                    </div>
                </div>
            </section>

            <section class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-indigo-300 transition-colors">
                <h2 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-emerald-500"></span> 3. Ë®≠ÂÆöÁõÆÊ®ôÂèóÁúæ (Target)
                </h2>
                <div class="flex flex-wrap gap-2" id="audience-container">
                    </div>
            </section>

        </div>

        <div class="lg:col-span-7 flex flex-col h-[calc(100vh-8rem)] sticky top-24">
            <div class="bg-slate-900 rounded-xl shadow-2xl border border-slate-700 flex flex-col h-full overflow-hidden transform transition-all">
                <div class="bg-slate-800 px-4 py-3 flex justify-between items-center border-b border-slate-700">
                    <div class="flex items-center gap-2">
                        <div class="flex gap-1.5">
                            <div class="w-2.5 h-2.5 rounded-full bg-red-500"></div>
                            <div class="w-2.5 h-2.5 rounded-full bg-yellow-500"></div>
                            <div class="w-2.5 h-2.5 rounded-full bg-green-500"></div>
                        </div>
                        <span class="ml-3 text-slate-400 text-xs font-mono opacity-70">prompt_generator.md</span>
                    </div>
                    <button id="copy-btn" class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-1.5 rounded-md text-sm font-medium transition-all flex items-center gap-2 shadow-lg shadow-indigo-500/20 active:scale-95">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                        <span id="copy-text">Ë§áË£ΩÊåá‰ª§</span>
                    </button>
                </div>
                <textarea id="output" class="flex-1 bg-[#0f172a] text-slate-300 p-6 font-mono text-sm leading-relaxed focus:outline-none resize-none selection:bg-indigo-500 selection:text-white" readonly></textarea>
                <div class="bg-slate-800 px-4 py-2 text-[10px] text-slate-500 flex justify-between items-center border-t border-slate-700">
                    <span class="flex items-center gap-2"><span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span>Ready to Generate</span>
                    <span id="char-count" class="font-mono">0 chars</span>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- 1. ÂÆåÊï¥Ë≥áÊñôÂ∫´ (47 Styles) ---
        const styleDatabase = {
            "business": {
                label: "üíº ÂïÜÊ•≠ËàáÊà∞Áï• (Business)",
                styles: [
                    { id: "mckinsey", label: "È∫•ËÇØÈå´È°ßÂïè (McKinsey)", desc: "MECEÂéüÂâá„ÄÅÊ•µÂ∫¶ÂÆ¢ËßÄ„ÄÅÊà∞Áï•Â∞éÂêë", instr: "Use MECE (Mutually Exclusive, Collectively Exhaustive) principle. Tone: Highly professional, objective, and executive. Use phrases like 'Strategic Implications', 'Key Drivers', and 'Actionable Insights'." },
                    { id: "vc", label: "ÁüΩË∞∑ÂâµÊäï (VC)", desc: "ÈáçË¶ñÊàêÈï∑„ÄÅROI„ÄÅÂ∏ÇÂ†¥Ë¶èÊ®°", instr: "Focus on 'Scalability', 'Moat', 'Traction', and 'ROI'. Tone: Fast-paced, sharp, assessing growth potential. Highlight 'Unfair Advantages' and 'Market Size'." },
                    { id: "legal", label: "Ê≥ïÂæãÂêàË¶è (Legal)", desc: "Âö¥Ë¨π„ÄÅÁÑ°Ê≠ßÁæ©„ÄÅÂÆöÁæ©Ê∏ÖÊô∞", instr: "Tone: Rigorous, unambiguous, and formal. Use precise definitions. Structure arguments with 'Premise', 'Evidence', and 'Conclusion'. Avoid vague language." },
                    { id: "agile", label: "ÊïèÊç∑Áî¢ÂìÅÁ∂ìÁêÜ (PM)", desc: "User Story„ÄÅÁóõÈªû„ÄÅÈ©óÊî∂Ê®ôÊ∫ñ", instr: "Focus on User Stories ('As a user...'). Define 'Acceptance Criteria'. Prioritize 'Pain Points' and 'Solutions'. Tone: Iterative, user-centric, and practical." },
                    { id: "crisis", label: "Âç±Ê©üÂÖ¨Èóú (Crisis Comms)", desc: "Ë™†Êáá„ÄÅ‰∫ãÂØ¶ÊæÑÊ∏Ö„ÄÅÂæåÁ∫åË°åÂãï", instr: "Tone: Empathetic but controlled. Focus on 'Fact Clarification', 'Immediate Actions', and 'Future Prevention'. Reassure stakeholders without over-promising." }
                ]
            },
            "visual": {
                label: "üé® Ë¶ñË¶∫ËàáË®≠Ë®àÊÄùÁ∂≠ (Design)",
                styles: [
                    { id: "cyberpunk", label: "Ë≥ΩÂçöÈæêÂÖã (Cyberpunk)", desc: "È´òÁßëÊäÄ‰ΩéÁîüÊ¥ª„ÄÅÈúìËôπ„ÄÅÁ†¥Â£ûÂºè", instr: "Tone: High-tech, disruptive, edgy. Use metaphors of 'Neon', 'Data streams', and 'System override'. Highlight contrasts between old and new." },
                    { id: "swiss", label: "ÁëûÂ£´Ê•µÁ∞° (Swiss Style)", desc: "ÁïôÁôΩ„ÄÅÁ∂≤Ê†º„ÄÅÊ†∏ÂøÉËßÄÈªû", instr: "Tone: Minimalist, clean, structured. Maximize 'White Space' in the text layout. Remove all fluff. Focus on high signal-to-noise ratio." },
                    { id: "sketch", label: "ÊâãÁπ™Á≠ÜË®ò (Sketchnote)", desc: "Ë¶™Âàá„ÄÅÊØîÂñª„ÄÅË¶ñË¶∫ÂåñÊèèËø∞", instr: "Tone: Warm, approachable, hand-crafted feel. Use visual metaphors (e.g., 'Picture this as...'). Suggest doodles or icons to represent data." },
                    { id: "natgeo", label: "ÂúãÂÆ∂Âú∞ÁêÜ (NatGeo)", desc: "ÂÆèÂ§ßÊïò‰∫ã„ÄÅ‰∫∫ÊñáËàáËá™ÁÑ∂", instr: "Tone: Narrative, observant, grand. Combine hard data with human stories. Describe the 'Landscape' of the information vividly." },
                    { id: "blueprint", label: "ËóçÂúñÂ∑•Á®ã (Blueprint)", desc: "ÁµêÊßã„ÄÅÂ∞∫ÂØ∏„ÄÅÁ≤æÁ¢∫Â∫¶", instr: "Tone: Precise, architectural. Use terms like 'Foundation', 'Framework', 'Load-bearing'. Focus on the structural integrity of the ideas." }
                ]
            },
            "academic": {
                label: "üéì Â≠∏Ë°ìËàáÊïôËÇ≤ (Academic)",
                styles: [
                    { id: "ivy", label: "Â∏∏Êò•Ëó§ÊïôÊéà (Ivy League)", desc: "ÂºïÁî®Âö¥Ë¨π„ÄÅÊ∑±Â∫¶ÊâπÂà§", instr: "Tone: Scholarly, rigorous, critical. Use complex sentence structures. Require citations for claims. Analyze from multiple theoretical perspectives." },
                    { id: "eli5", label: "Ë≤ªÊõºÊäÄÂ∑ß (ELI5)", desc: "Ê•µÁ∞°ÊØîÂñª„ÄÅÁÑ°Ë°ìË™û", instr: "Explain Like I'm 5. Use simple analogies (Lego, Pizza, Cars). BANNED: Jargon and complex acronyms. Focus on the core 'Why'." },
                    { id: "socratic", label: "ËòáÊ†ºÊãâÂ∫ï (Socratic)", desc: "ÊèêÂïèÂºïÂ∞é„ÄÅÂèçÊÄù", instr: "Do not give direct answers. Use guiding questions to lead the reader to the conclusion. Foster critical thinking and self-discovery." },
                    { id: "debater", label: "ËæØË´ñÈÅ∏Êâã (Debater)", desc: "Ê≠£Âèç‰∏¶Èô≥„ÄÅÈÇèËºØÊîªÈò≤", instr: "Structure: Argument, Rebuttal, Evidence. Present 'Pros' and 'Cons' sharply. Focus on logical fallacies and strong counter-arguments." },
                    { id: "history", label: "Ê≠∑Âè≤Ë™™Êõ∏‰∫∫ (Historian)", desc: "ÊôÇÈñìËª∏„ÄÅÂõ†Êûú„ÄÅÊïÖ‰∫ãÊÄß", instr: "Narrate chronologically. Emphasize 'Cause and Effect'. Place data in a historical context. Tell the 'Story' behind the numbers." }
                ]
            },
            "media": {
                label: "üì¢ Â™íÈ´îËàáÂÇ≥Êí≠ (Media)",
                styles: [
                    { id: "ted", label: "TED ÊºîË¨õ (TED Talk)", desc: "ÂïüÁôºÊÄß„ÄÅÂÄã‰∫∫ÊïÖ‰∫ã„ÄÅÈáëÂè•", instr: "Structure: The Hook -> The Struggle -> The Epiphany. Tone: Inspiring, passionate. Include 'Quotable Moments' and a strong 'Call to Adventure'." },
                    { id: "techcrunch", label: "ÁßëÊäÄÂ™íÈ´î (TechCrunch)", desc: "Ë∂®Âã¢„ÄÅÂïÜÊ•≠ÈÇèËºØ„ÄÅGeeky", instr: "Focus on 'Disruption', 'Tech Stack', and 'Market fit'. Tone: Modern, geeky, analytical. specific to the tech industry ecosystem." },
                    { id: "viral", label: "ÁóÖÊØíË°åÈä∑ (Viral)", desc: "ÊÉÖÁ∑íÊ∏≤Êüì„ÄÅÈ©öÂòÜËôü", instr: "Use 'Clickbait' style headers. High emotional engagement. Short, punchy sentences. Use formatting like BOLD CAPS for emphasis." },
                    { id: "noir", label: "ÈªëËâ≤ÂÅµÊé¢ (Noir)", desc: "ÂÜ∑Á°¨„ÄÅÁç®ÁôΩ„ÄÅË™øÊü•ÊÑü", instr: "Tone: Cynical, gritty, monochromatic. Write like a detective's monologue. 'It was a rainy night when the data came in...' Uncover the 'Truth'." },
                    { id: "podcast", label: "Podcast ËÖ≥Êú¨", desc: "Âè£Ë™ûÂåñ„ÄÅÂ∞çË©±ÊÑü", instr: "Format as a script. Include cues like [Music Fades In], [Laughter]. Tone: Conversational, casual, engaging audio-first storytelling." }
                ]
            },
            "data": {
                label: "üìä Êï∏ÊìöËàáÈÇèËºØ (Data)",
                styles: [
                    { id: "json", label: "JSON ÁµêÊßã", desc: "Á®ãÂºèÁ¢º„ÄÅKey-Value", instr: "Output strictly in JSON format. Use clear Key-Value pairs. No conversational filler. Ideal for data parsing." },
                    { id: "swot", label: "SWOT ÂàÜÊûê", desc: "ÂÑ™Âä£Âã¢Áü©Èô£", instr: "Strictly categorize into: Strengths (Internal), Weaknesses (Internal), Opportunities (External), Threats (External). Bullet points only." },
                    { id: "gamestats", label: "ÈÅäÊà≤Êï∏ÂÄº (Game Stats)", desc: "Â±¨ÊÄßÂåñ„ÄÅÁ≠âÁ¥öÂà∂", instr: "Quantify data as 'Attributes' (e.g., Agility, Intelligence). Assign 'Levels' or 'Ranks' to concepts. Use RPG UI terminology." },
                    { id: "checklist", label: "Ê∏ÖÂñÆÊéß (Checklist)", desc: "SOP„ÄÅË§áÈÅ∏Ê°Ü", instr: "Format as a checklist [ ]. Break down complex tasks into single steps. Focus on 'Actionability'. No theory, just doing." },
                    { id: "matrix", label: "ÊØîËºÉÁü©Èô£ (Matrix)", desc: "Ê©´Á∏±Ëª∏Â∞çÊØî", instr: "Create a Markdown table. Columns: Competitors/Options. Rows: Features/Specs. Highlight differences clearly." }
                ]
            },
            "game": {
                label: "üéÆ ÈÅäÊà≤Ëàá‰∫íÂãï (Gaming)",
                styles: [
                    { id: "dm", label: "Âú∞‰∏ãÂüé‰∏ª (D&D DM)", desc: "ÂÜíÈö™Êïò‰∫ã„ÄÅÁ¨¨‰∫å‰∫∫Á®±", instr: "Role: Dungeon Master. Describe challenges as 'Monsters'. Describe resources as 'Loot'. Use second-person ('You enter the room...')." },
                    { id: "rpg_item", label: "RPG Ë£ùÂÇô (Item Desc)", desc: "ÂÇ≥Â•áÁâ©ÂìÅË™™Êòé", instr: "Format as a Legendary Item tooltip. Include: Name, Type, Stats, Passive Effects, and Lore Text (flavor text)." },
                    { id: "cyoa", label: "‰∫íÂãïÂ∞èË™™ (CYOA)", desc: "Êèê‰æõÈÅ∏È†Ö A/B/C", instr: "Do not finish the story. Present a scenario based on data, then offer 3 distinct choices (Option A, B, C) leading to different outcomes." },
                    { id: "patch", label: "Êõ¥Êñ∞ÂÖ¨Âëä (Patch Notes)", desc: "Buff/Nerf„ÄÅ‰øÆÂæ©", instr: "Use terms: 'Buffed', 'Nerfed', 'Bug Fixes', 'QoL Improvements'. Tone: Dev-blog style, concise and technical." },
                    { id: "esports", label: "ÈõªÁ´∂Ë≥ΩË©ï (Caster)", desc: "È´òËÉΩÈáè„ÄÅÈóúÈçµPlay", instr: "Tone: High energy, shouting, hype! Highlight 'MVP' moments and 'Critical Plays' in the data. Fast-paced delivery." }
                ]
            },
            "metaphor": {
                label: "üß© Èö±ÂñªËàáÈÅ∑Áßª (Metaphor)",
                styles: [
                    { id: "chef", label: "Á±≥ÂÖ∂Êûó‰∏ªÂªö (Chef)", desc: "È£üË≠ú„ÄÅÈ£üÊùê„ÄÅÁÉπÈ£™", instr: "Metaphor: Cooking. Data = Ingredients. Process = Recipe. Outcome = Dish. Use sensory words (Taste, Smell, Texture)." },
                    { id: "medical", label: "Ëá®Â∫äË®∫Êñ∑ (Medical)", desc: "ÁóáÁãÄ„ÄÅËôïÊñπ„ÄÅÈ†êÂæå", instr: "Format: Symptoms (Current State), Diagnosis (Root Cause), Prescription (Action), Prognosis (Future). Tone: Sterile, clinical." },
                    { id: "blueprint_arch", label: "Âª∫ÁØâÂ∏´ (Architect)", desc: "Á©∫Èñì„ÄÅÂãïÁ∑ö„ÄÅÊùêË≥™", instr: "Focus on 'Space', 'Flow', and 'Materials'. Describe the information architecture as a physical building." },
                    { id: "military", label: "Ëªç‰∫ãÁ∞°Â†± (Military)", desc: "‰ªªÂãô„ÄÅÂü∑Ë°å„ÄÅÁÑ°Âª¢Ë©±", instr: "Format: SITUATION, MISSION, EXECUTION. Tone: Commanding, direct. Use NATO phonetic alphabet if applicable. Zero fluff." },
                    { id: "script", label: "ÈõªÂΩ±ÂäáÊú¨ (Screenplay)", desc: "Â†¥ÊôØ„ÄÅÂãï‰Ωú„ÄÅÂ∞çÁôΩ", instr: "Format: EXT. LOCATION - DAY. Describe action lines and dialogue. Think cinematically." }
                ]
            },
            "persona": {
                label: "üé≠ ËßíËâ≤ËàáË™ûÊ∞£ (Persona)",
                styles: [
                    { id: "victorian", label: "Á∂≠Â§öÂà©‰∫ûÁ¥≥Â£´", desc: "ÂÑ™ÈõÖ„ÄÅÂÜóÈï∑„ÄÅÂè§ÂÖ∏", instr: "Tone: 19th Century Aristocrat. Use archaic words ('My dearest', 'Indeed', 'Preposterous'). Be polite but excessively verbose." },
                    { id: "genz", label: "Z‰∏ñ‰ª£ (Gen Z)", desc: "ÊµÅË°åË™û„ÄÅEmoji„ÄÅÁü≠Âè•", instr: "Tone: Internet slang (no cap, bet, sus). Use lowercase. Use emojis liberally üíÄüî•. Keep it short and chaotic." }
                ]
            },
            "visual_gen": {
                label: "üëÅÔ∏è Ë¶ñË¶∫ÁîüÊàêÂ∞àÁî® (Prompting)",
                styles: [
                    { id: "wes", label: "È≠èÊñØÂÆâÂæ∑Ê£Æ (Wes Anderson)", desc: "Â∞çÁ®±„ÄÅÁ≤âÂ´©Ëâ≤„ÄÅÁΩÆ‰∏≠", instr: "Visual Description: Symmetrical composition, pastel color palette, flat lay, quirky objects, centered framing." },
                    { id: "ukiyo", label: "ÊµÆ‰∏ñÁπ™ (Ukiyo-e)", desc: "ÁâàÁï´„ÄÅÁ∑öÊ¢ù„ÄÅÊµ∑Êµ™", instr: "Visual Description: Woodblock print style, bold outlines, flat perspective, nature motifs (waves, mountains)." },
                    { id: "pixel", label: "ÂÉèÁ¥†ËóùË°ì (8-bit)", desc: "Âæ©Âè§ÈÅäÊà≤„ÄÅ‰ΩéËß£Êûê", instr: "Visual Description: Low resolution, limited color palette, blocky shapes, retro video game aesthetic." },
                    { id: "dataism", label: "Êï∏Êìö‰∏ªÁæ© (Dataism)", desc: "‰ª£Á¢ºÊµÅ„ÄÅÈß≠ÂÆ¢‰ªªÂãô", instr: "Visual Description: Glowing green code, digital rain, network nodes, dark background, abstract data visualization." },
                    { id: "paper", label: "Ââ™Á¥ôËóùË°ì (Paper Cut)", desc: "Â±§Ê¨°„ÄÅÈô∞ÂΩ±„ÄÅË≥™ÊÑü", instr: "Visual Description: Layered colored paper, deep shadows, 3D depth, physical texture, craft aesthetic." }
                ]
            },
            "constraint": {
                label: "üìê ÁµêÊßãÈôêÂà∂ (Structural)",
                styles: [
                    { id: "haiku", label: "‰ø≥Âè• (Haiku)", desc: "5-7-5 Èü≥ÁØÄ", instr: "Strict Constraint: Summarize key points using only Haiku structure (5-7-5 syllables). Abstract and poetic." },
                    { id: "amazon", label: "‰∫ûÈ¶¨ÈÅúÂÖ≠È†Å (6-Pager)", desc: "Á¥îÊñáÂ≠óÊïò‰∫ã„ÄÅÁÑ°Ê¢ùÂàó", instr: "Strict Constraint: Continuous narrative text only. NO bullet points. Focus on clear, full sentences and logical flow." },
                    { id: "flashcard", label: "Ë®òÊÜ∂Âç°Áâá (Flashcards)", desc: "ÂïèËàáÁ≠î", instr: "Format: Q: [Question] \n A: [Answer]. optimized for spaced repetition learning." },
                    { id: "thread", label: "Êé®Áâπ‰∏≤ (Twitter)", desc: "10Ê¢ùÊé®Êñá„ÄÅ280Â≠ó", instr: "Format: A thread of 10 tweets. Each under 280 chars. Number them 1/10. Start with a Hook, end with a CTA." },
                    { id: "faq", label: "Â∏∏Ë¶ãÂïèÁ≠î (FAQ)", desc: "È†êÂà§ÂïèÈ°å„ÄÅÂêåÁêÜÂõûÁ≠î", instr: "Anticipate user confusion. Format as 'User Asks' and 'Expert Answers'. Focus on resolving doubts." }
                ]
            }
        };

        // --- 2. Ê†ºÂºèË®≠ÂÆö (Types) ---
        const types = [
            { id: 'infographic', label: 'Ë≥áË®äÂúñË°® (Infographic)', icon: 'üìä', template: "Describe visual layout for charts. Provide: [Visual Concept], [Data Points], [Caption]." },
            { id: 'slide', label: 'Á∞°Â†±Â§ßÁ∂± (Slides)', icon: 'üìΩÔ∏è', template: "Outline 10-15 slides. For each: Title, Bullet Points, and Speaker Notes." }
        ];

        const audiences = [
            { id: 'general', label: '‰∏ÄËà¨Â§ßÁúæ', focus: 'Simplicity & Engagement' },
            { id: 'executive', label: 'È´òÈöé‰∏ªÁÆ°', focus: 'ROI & Strategy' },
            { id: 'technical', label: 'ÊäÄË°ìÂ∞àÂÆ∂', focus: 'Specs & Implementation' },
            { id: 'student', label: 'Â≠∏Áîü/ÂàùÂ≠∏ËÄÖ', focus: 'Learning & Fundamentals' }
        ];

        let state = {
            type: types[0],
            category: 'business',
            style: styleDatabase['business'].styles[0],
            audience: audiences[0]
        };

        const els = {
            typeContainer: document.getElementById('type-container'),
            catSelect: document.getElementById('category-select'),
            styleSelect: document.getElementById('style-select'),
            styleName: document.getElementById('style-name-display'),
            styleDesc: document.getElementById('style-desc-display'),
            audContainer: document.getElementById('audience-container'),
            output: document.getElementById('output'),
            charCount: document.getElementById('char-count')
        };

        function renderTypes() {
            els.typeContainer.innerHTML = '';
            types.forEach(t => {
                const btn = document.createElement('button');
                const isActive = state.type.id === t.id;
                btn.className = `p-3 rounded-lg border text-left flex items-center gap-3 transition-all ${isActive ? 'border-indigo-600 bg-indigo-50 ring-1 ring-indigo-600 shadow-sm' : 'border-slate-200 hover:bg-slate-50'}`;
                btn.innerHTML = `<span class="text-xl">${t.icon}</span><span class="font-medium text-sm text-slate-700">${t.label}</span>`;
                btn.onclick = () => { state.type = t; renderTypes(); updatePreview(); };
                els.typeContainer.appendChild(btn);
            });
        }

        function renderCategories() {
            els.catSelect.innerHTML = '';
            Object.keys(styleDatabase).forEach(key => {
                const opt = document.createElement('option');
                opt.value = key;
                opt.textContent = styleDatabase[key].label;
                els.catSelect.appendChild(opt);
            });
            els.catSelect.value = state.category;
            els.catSelect.onchange = (e) => {
                const newCat = e.target.value;
                state.category = newCat;
                state.style = styleDatabase[newCat].styles[0];
                renderStyles();
                updatePreview();
            };
        }

        function renderStyles() {
            els.styleSelect.innerHTML = '';
            const stylesInCat = styleDatabase[state.category].styles;
            stylesInCat.forEach(s => {
                const opt = document.createElement('option');
                opt.value = s.id;
                opt.textContent = s.label;
                els.styleSelect.appendChild(opt);
            });
            els.styleSelect.value = state.style.id;
            els.styleName.textContent = state.style.label;
            els.styleDesc.textContent = state.style.desc;
            els.styleSelect.onchange = (e) => {
                const selectedId = e.target.value;
                state.style = stylesInCat.find(s => s.id === selectedId);
                els.styleName.textContent = state.style.label;
                els.styleDesc.textContent = state.style.desc;
                updatePreview();
            };
        }

        function renderAudiences() {
            els.audContainer.innerHTML = '';
            audiences.forEach(a => {
                const btn = document.createElement('button');
                const isActive = state.audience.id === a.id;
                btn.className = `px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${isActive ? 'bg-indigo-600 text-white border-indigo-600 shadow-sm' : 'bg-white text-slate-600 border-slate-200 hover:border-indigo-400'}`;
                btn.textContent = a.label;
                btn.onclick = () => { state.audience = a; renderAudiences(); updatePreview(); };
                els.audContainer.appendChild(btn);
            });
        }

        // --- 3. Ê†∏ÂøÉ‰øÆÊ≠£ÔºöSafe Mode Prompt (ÂéªÈô§ ASCII / Âº∑Âà∂ Markdown) ---
        function generatePrompt() {
            return `# Task: Create a ${state.type.label}
Please act as an expert Content Strategist. Your goal is to synthesize the provided source material into a clear ${state.type.label}.

## Target Audience
- Who: ${state.audience.label}
- Focus: ${state.audience.focus}

## Style Guidelines
- **Style**: ${state.style.label}
- **Tone**: ${state.style.desc}
- **Instructions**: ${state.style.instr}
- **Language**: Traditional Chinese (ÁπÅÈ´î‰∏≠Êñá) for content.

## Visual Constraints (IMPORTANT)
- **NO ASCII ART**: Do not attempt to draw charts or diagrams using text characters (like |, -, +). It will display incorrectly.
- **Data Format**: Use standard Markdown Tables for any structured data.
- **Visuals**: Instead of drawing, describe the visual concept in text (e.g., "A pie chart showing...") or provide the data points clearly.

## Output Instructions
${state.type.template}

## Constraints
- **Source Based**: Strictly base your response on the provided sources in this notebook.
- **Format**: Use clear Markdown formatting (Headings, Bullet points). 

Please proceed step-by-step.`;
        }

        function updatePreview() {
            const txt = generatePrompt();
            els.output.value = txt;
            els.charCount.textContent = `${txt.length} chars`;
        }

        document.getElementById('copy-btn').addEventListener('click', () => {
            els.output.select();
            navigator.clipboard.writeText(els.output.value).then(() => {
                const span = document.getElementById('copy-text');
                const old = span.textContent;
                span.textContent = "Â∑≤Ë§áË£ΩÔºÅ";
                setTimeout(() => span.textContent = old, 2000);
            });
        });

        // Start
        renderTypes();
        renderCategories();
        renderStyles();
        renderAudiences();
        updatePreview();
    </script>
</body>
</html>
